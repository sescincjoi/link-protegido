<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema de Cadastro e Controle</title>

<style>
/* ================================
   ESTILOS GERAIS
================================ */
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f3f4f6;
}

header {
  background: #1e293b;
  padding: 1rem;
  color: white;
  font-size: 1.2rem;
  text-align: center;
}

/* ================================
   ABAS
================================ */
.tabs {
  display: flex;
  background: #0f172a;
}

.tab {
  padding: 1rem;
  color: white;
  cursor: pointer;
  flex: 1;
  text-align: center;
  transition: 0.3s;
}

.tab:hover {
  background: #1e293b;
}

.tab.active {
  background: #334155;
  font-weight: bold;
}

/* ================================
   √ÅREAS DAS ABAS
================================ */
.tab-content {
  display: none;
  padding: 1.5rem;
}

.tab-content.active {
  display: block;
  background: white;
}

/* ================================
   FORMUL√ÅRIOS E CAMPOS
================================ */
input, select {
  padding: .6rem;
  margin: .4rem 0;
  width: 100%;
  box-sizing: border-box;
}

button {
  padding: .7rem 1rem;
  margin-top: .7rem;
  cursor: pointer;
  border: none;
  background: #2563eb;
  color: white;
  border-radius: 4px;
  font-weight: bold;
}

button:hover {
  background: #1d4ed8;
}

/* ================================
   TABELAS
================================ */
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1rem;
}

th, td {
  padding: .7rem;
  border-bottom: 1px solid #ddd;
}

tr:hover {
  background: #f1f5f9;
}

/* ================================
   MODAL
================================ */
.modal-bg {
  position: fixed;
  top:0; left:0;
  width:100%; height:100%;
  background: rgba(0,0,0,.5);
  display:none;
  align-items:center;
  justify-content:center;
}

.modal {
  background:white;
  padding:2rem;
  width:90%;
  max-width:400px;
  border-radius:6px;
}
</style>
</head>
<body>

<header>Sistema ‚Äì Cadastro e Controle</header>

<!-- ================================
     ABAS
================================ -->
<div class="tabs">
  <div class="tab active" onclick="openTab('cadastro')">Cadastro</div>
  <div class="tab" onclick="openTab('estoque')">Estoque</div>
  <div class="tab" onclick="openTab('config')">Configura√ß√µes</div>
</div>

<!-- ================================
     ABA CADASTRO
================================ -->
<div id="cadastro" class="tab-content active">

  <h2>Novo Item</h2>

  <label>Nome do item</label>
  <input id="itemName">

  <label>Categoria</label>
  <select id="itemCategory"></select>

  <label>Quantidade inicial</label>
  <input id="itemQuantity" type="number" min="0">

  <button onclick="addItem()">Cadastrar</button>
</div>

<!-- ================================
     ABA ESTOQUE
================================ -->
<div id="estoque" class="tab-content">
  <h2>Controle de Estoque</h2>

  <button onclick="loadItems()">üîÑ Recarregar</button>

  <table id="itemsTable">
    <thead>
      <tr>
        <th>ID</th>
        <th>Item</th>
        <th>Categoria</th>
        <th>Qtd</th>
        <th>A√ß√µes</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- ================================
     ABA CONFIGURA√á√ïES
================================ -->
<div id="config" class="tab-content">
  <h2>Configura√ß√µes do Sistema</h2>

  <label>Adicionar nova categoria</label>
  <input id="newCategory">

  <button onclick="addCategory()">Adicionar Categoria</button>

  <h3>Categorias existentes</h3>
  <ul id="categoriesList"></ul>

  <button style="background:#dc2626" onclick="openResetModal()">Resetar TUDO</button>
</div>

<!-- ================================
     MODAL DE RESET
================================ -->
<div id="modalReset" class="modal-bg">
  <div class="modal">
    <h3>Confirmar Reset Geral?</h3>
    <p>Todos os dados ser√£o apagados!</p>
    <button onclick="resetSystem()" style="background:#dc2626">Sim, apagar tudo</button>
    <button onclick="closeResetModal()">Cancelar</button>
  </div>
</div>

<script>
/* ================================
   CONFIG
================================ */
const SCRIPT_URL = "COLE_AQUI_SEU_WEBAPP_URL";

/* ================================
   SISTEMA DE ABAS
================================ */
function openTab(name) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
  document.querySelector(`[onclick="openTab('${name}')"]`).classList.add('active');
  document.getElementById(name).classList.add('active');
}

/* ================================
   CATEGORIAS
================================ */
async function loadCategories() {
  const res = await fetch(SCRIPT_URL + "?action=getCategories");
  const categories = await res.json();

  const select = document.getElementById("itemCategory");
  const list = document.getElementById("categoriesList");

  select.innerHTML = "";
  list.innerHTML = "";

  categories.forEach(cat => {
    const opt = document.createElement("option");
    opt.textContent = cat;
    select.appendChild(opt);

    const li = document.createElement("li");
    li.textContent = cat;
    list.appendChild(li);
  });
}

async function addCategory() {
  const name = document.getElementById("newCategory").value.trim();
  if (!name) return alert("Digite algo!");

  await fetch(SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify({ action: "addCategory", name })
  });

  document.getElementById("newCategory").value = "";
  loadCategories();
}

/* ================================
   ITENS
================================ */
async function addItem() {
  const name = document.getElementById("itemName").value.trim();
  const category = document.getElementById("itemCategory").value;
  const quantity = document.getElementById("itemQuantity").value;

  if (!name) return alert("Nome obrigat√≥rio");

  await fetch(SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify({
      action: "addItem",
      name,
      category,
      quantity: Number(quantity)
    })
  });

  document.getElementById("itemName").value = "";
  document.getElementById("itemQuantity").value = "";

  loadItems();
  openTab("estoque");
}

async function loadItems() {
  const res = await fetch(SCRIPT_URL + "?action=getItems");
  const items = await res.json();

  const tbody = document.querySelector("#itemsTable tbody");
  tbody.innerHTML = "";

  items.forEach(item => {
    const tr = document.createElement("tr");

    tr.innerHTML = `
      <td>${item.id}</td>
      <td>${item.name}</td>
      <td>${item.category}</td>
      <td>${item.quantity}</td>
      <td>
        <button onclick="modifyQty('${item.id}', 1)">+1</button>
        <button onclick="modifyQty('${item.id}', -1)">-1</button>
        <button onclick="deleteItem('${item.id}')" style="background:#dc2626">Excluir</button>
      </td>
    `;

    tbody.appendChild(tr);
  });
}

async function modifyQty(id, delta) {
  await fetch(SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify({ action: "modifyQty", id, delta })
  });
  loadItems();
}

async function deleteItem(id) {
  if (!confirm("Excluir item?")) return;

  await fetch(SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify({ action: "deleteItem", id })
  });

  loadItems();
}

/* ================================
   RESET GERAL
================================ */
function openResetModal() {
  document.getElementById("modalReset").style.display = "flex";
}

function closeResetModal() {
  document.getElementById("modalReset").style.display = "none";
}

async function resetSystem() {
  await fetch(SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify({ action: "reset" })
  });

  closeResetModal();
  loadItems();
  loadCategories();
}

/* ================================
   INICIALIZA√á√ÉO
================================ */
loadCategories();
loadItems();
</script>

</body>
</html>